# Docker compose file dedicated to Unibuild builds

###
# Some repeated defaults:
# tmpfs and /sys/fs/cgroup volumes are needed for systemd to work properly
# /app is where the git repositories will be shared with the host
###
x-tmpfs:
  &default-tmpfs
  - /run
  - /run/lock
  - /tmp

x-volumes:
  &default-volumes
  - ${DIR_TO_BE_BUILT}:/app
 
services:
  el7:
    image: ghcr.io/perfsonar/unibuild/el7:latest
    volumes: *default-volumes
  el8:
    image: ghcr.io/perfsonar/unibuild/el8:latest
    volumes: *default-volumes
  el9:
    image: ghcr.io/perfsonar/unibuild/el9:latest
    volumes: *default-volumes
  d11_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/d11:latest@sha256:13f76dd29e9b0e18ca8ca93953f1ef27c9ff3f3525aa0715324c1b35ea4ef957
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d11_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/d11:latest@sha256:e28b06698aeba30047150cbdcbdaa652402c5861155d517ed993bad2eb5dd7c0
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d11_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/d11:latest@sha256:670bdca18e27cd2a5fada376a901291c1755ba32f530c5a4841f583c136f0d7c
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d11_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/d11:latest@sha256:c91e0aeca80efd829229966801dd6d511e1bc8fe2b2a3ea2772c1889ee6beb0e
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d12_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/d12:latest@sha256:ad3ac6de691fe7bfc7856b9db2515797333b031114bfb5825f5ab206fbf2e990
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d12_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/d12:latest@sha256:7ec725f244b0200e125126908c3958fc7b663c0ca2bc6595096c32059ffcb499
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d12_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/d12:latest@sha256:40707a35e40c22b3c99a4371db3c5349260397f0835edb42525434baba96696d
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d12_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/d12:latest@sha256:e6534a1ac7d391a2b70e0c4783f15923a524455b6e2926f00d3b17eba15cb4df
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:a187e032af596905ed69ecc6087307eef0c23f9aa9771a08d5884178de55803c
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:f436c22bd571e3b6a8234cda7a31611aec3852e286ad8af20633179a09f1c624
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:feda9e3ae5899deb210cf6432bd98c562ce40a1f3da522798a4af72b349f694a
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:3a2ee4d2a799b1936603c61417213a8dc909127599e5f3e097a7ff5dfe97741d
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u22_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/u22:latest@sha256:20238e2f5c3e8cee981f053f36d555caa960d3a3a47d6a6b2df4692f48f023d1
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u22_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/u22:latest@sha256:e88f9c10950a34daf3cb6d20e59d08d65c4bc64285333867759b721284f9ac93
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u22_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/u22:latest@sha256:77cdeb9abe7d8cb0a5bc7f63d85520df046501fe3537eb3d53a0e69440730ce6
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u22_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/u22:latest@sha256:c660713701be60a7d9dbf1eb3dd20b8aeb0f9c218d5aa2b0cb8000b273a89313
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u24_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/u24:latest@sha256:c0b1e4afe79845b216766babe4306b86b132ef54b9577350f0982c709c542579
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u24_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/u24:latest@sha256:de039a86063745be39a193fa5070d159041875bb75c63fec091fb03dec85d099
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u24_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/u24:latest@sha256:61da8e4da7153d2bf6921b6c485d8da42b61b9fa87361230a34365df8b9cf936
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u24_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/u24:latest@sha256:a672e5a31d9f66fda06f18a2f7e51af757bb1f1c98b3c23f3687219202294b61
    command: bash -c "sleep infinity"
    volumes: *default-volumes

