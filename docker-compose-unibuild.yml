# Docker compose file dedicated to Unibuild builds
version: '3.9'

###
# Some repeated defaults:
# tmpfs and /sys/fs/cgroup volumes are needed for systemd to work properly
# /app is where the git repositories will be shared with the host
###
x-tmpfs:
  &default-tmpfs
  - /run
  - /run/lock
  - /tmp

x-volumes:
  &default-volumes
  - ${DIR_TO_BE_BUILT}:/app
 
services:
  el7:
    image: ghcr.io/perfsonar/unibuild/el7:latest
    volumes: *default-volumes
  el8:
    image: ghcr.io/perfsonar/unibuild/el8:latest
    volumes: *default-volumes
  el9:
    image: ghcr.io/perfsonar/unibuild/el9:latest
    volumes: *default-volumes
  d10_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/d10:latest@sha256:9b66916478a122e2863929c7d10a60c39ffee1c03125c3b7d7913fabf3b51223
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d10_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/d10:latest@sha256:6276c5fe65b9f67a0b039d02a696f91cb2b2bbb9333e991ead6ba6076e04683d
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d10_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/d10:latest@sha256:2999751397b4b992b3f764e3e9d901ed1bca4ebaecc751994d15995b9d7c460c
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  d10_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/d10:latest@sha256:8a96de2a03d9f051ef65a225b9fad61db486b73afc325deff5baf5200ce018c4
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u18_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/u18:latest@sha256:d8b3c9fec7de41cc5fd25871c440ef1e6bc37ffecb03b21c58c04666ee76184c
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u18_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/u18:latest@sha256:68bbc7ae2309627ca4b27662a8cc90ee930158c5af6bceefea0e7420ca8d27b6
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u18_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/u18:latest@sha256:df2d92ac10cb24f1fd6a33e865e6c0d1a33b1e15da41bc726a8ad831ba89d9ae
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u18_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/u18:latest@sha256:6ba57c8002600af068d3f70af060323d02a04575f00c020d1c43cdb63e7c1cff
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_amd64:
    platform: "linux/amd64"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:6940527bd0f3cf004d37998bc1be88710c8eb9ce45ced319cbdef8103b93ceb3
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_arm64:
    platform: "linux/arm64"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:1cd12943614537ae41c9a0be931875bb771c31865a26963a44c2fbd054e1cfa8
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_armv7:
    platform: "linux/arm/v7"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:ecdda2536876566b990d499ab94f3bf9d84380b029bc87dbbfd77df73208f103
    command: bash -c "sleep infinity"
    volumes: *default-volumes
  u20_ppc64le:
    platform: "linux/ppc64le"
    image: ghcr.io/perfsonar/unibuild/u20:latest@sha256:f32fb00333e05dabdf4c0abd0b8a7aebafa3269e03dbc3638c783a54e12b5137
    command: bash -c "sleep infinity"
    volumes: *default-volumes

